<!DOCTYPE html><html><head><meta charset="utf-8"><title>ExpressionEngine Parse Order</title><link href="style.css" rel="stylesheet"><style>.alpha_list{list-style:upper-alpha}.alpha_list>li::marker{font-weight:700}sup{font-weight:700}</style><link href="//dash_ref/Category/Quick Reference Guide/1"><link href="//dash_ref_Quick Reference Guide/Entry/site variables/0"><link href="//dash_ref_Quick Reference Guide/Entry/conditionals/0"><link href="//dash_ref_Quick Reference Guide/Entry/segment variables/0"><link href="//dash_ref_Quick Reference Guide/Entry/template route segment variables/0"><link href="//dash_ref_Quick Reference Guide/Entry/embed variables/0"><link href="//dash_ref_Quick Reference Guide/Entry/layout variables/0"><link href="//dash_ref_Quick Reference Guide/Entry/error conditionals/0"><link href="//dash_ref_Quick Reference Guide/Entry/date string constants/0"><link href="//dash_ref_Quick Reference Guide/Entry/date variables/0"><link href="//dash_ref_Quick Reference Guide/Entry/consent variables/0"><link href="//dash_ref_Quick Reference Guide/Entry/caching (if not exists)/0"><link href="//dash_ref_Quick Reference Guide/Entry/php input/0"><link href="//dash_ref_Quick Reference Guide/Entry/conditionals/0"><link href="//dash_ref_Quick Reference Guide/Entry/preload replace/0"><link href="//dash_ref_Quick Reference Guide/Entry/extension tags/0"><link href="//dash_ref_Quick Reference Guide/Entry/php output/0"><link href="//dash_ref_Quick Reference Guide/Entry/caching (if needed)/0"><link href="//dash_ref_Quick Reference Guide/Entry/remaining conditionals/0"><link href="//dash_ref_Quick Reference Guide/Entry/associated template layouts/0"><link href="//dash_ref_Quick Reference Guide/Entry/all embeds/0"><link href="//dash_ref_Quick Reference Guide/Entry/layouts cleanup/0"><link href="//dash_ref_Quick Reference Guide/Entry/redirects triggered/0"><link href="//dash_ref_Quick Reference Guide/Entry/site and global vars/0"><link href="//dash_ref_Quick Reference Guide/Entry/variables processing/0"><link href="//dash_ref_Quick Reference Guide/Entry/security hashes/0"><link href="//dash_ref_Quick Reference Guide/Entry/cleanup output/0"></head><body><header><h1>ExpressionEngine Parse Order</h1></header><article><p></p><p>In what order does EE parse variables and tags in its templates?</p><ol><li>Read URI, pick template (via an intelligent and complex process)</li><li>Get template info, check permissions &amp; authentication</li><li>Get template<sup>A</sup> (from file if exists) Hook Here: <strong><em>template&#95;fetch_template</em></strong></li><li>“Static” templates are served “as-is”; ditto for templates that EE knows COULD be static... very efficient!</li></ol><p></p><section class="category"><h2 id="//dash_ref/Category/Quick Reference Guide/1">Quick Reference Guide</h2><div class="scrollable"><table><tr><th>Order</th><th>Tag</th><th>Description</th></tr><tr id="//dash_ref_Quick Reference Guide/Entry/site variables/0"><td class="td_notes"><div class="td_notes"><p>1</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{logged_in_*}</code> <code>{template_*}</code><sup>D</sup></p><p><code>{is_*_request}</code> <code>{site_*}</code></p><p><code>{last_segment}</code> <code>{current_url}</code></p><p><code>{current_path}</code> <code>{current_query_string}</code></p><p><code>{webmaster_path}</code></p></div></td><td class="td_notes"><div class="td_notes"><p><strong>site</strong> variables <em>(template partials, global_vars)</em><sup>ABC</sup></p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/conditionals/0"><td class="td_notes"><div class="td_notes"><p>2</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{if in_group()}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>conditionals</p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/segment variables/0"><td class="td_notes"><div class="td_notes"><p>3</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{segment_*}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>segment variables</p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/template route segment variables/0"><td class="td_notes"><div class="td_notes"><p>4</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{segment:* }</code></p></div></td><td class="td_notes"><div class="td_notes"><p>template route segment variables</p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/embed variables/0"><td class="td_notes"><div class="td_notes"><p>5</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{embed:}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>variables <em>(only if template is called as an embed)</em></p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/layout variables/0"><td class="td_notes"><div class="td_notes"><p>6</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{layout:}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>variables <em>(only if it is called by a layout tag)</em></p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/error conditionals/0"><td class="td_notes"><div class="td_notes"><p>7</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{errors}{/errors}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>error conditionals</p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/date string constants/0"><td class="td_notes"><div class="td_notes"><p>8</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{current_time format=&quot;{DATE_ATOM}&quot;}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>date string constants</p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/date variables/0"><td class="td_notes"><div class="td_notes"><p>9</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{template_edit_date}</code></p><p><code>{current_time}</code></p><p><code>{variable_time}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>date variables</p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/consent variables/0"><td class="td_notes"><div class="td_notes"><p>10</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{consent:}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>consent variables</p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/caching (if not exists)/0"><td class="td_notes"><div class="td_notes"><p>11</p></div></td><td class="td_notes"><div class="td_notes"><p><strong>Caching...</strong></p></div></td><td class="td_notes"><div class="td_notes"><p>If template is cached, skip ahead to #18</p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/php input/0"><td class="td_notes"><div class="td_notes"><p>12</p></div></td><td class="td_notes"><div class="td_notes"><p><code>&lt;?php ?&gt;</code></p></div></td><td class="td_notes"><div class="td_notes"><p>on input</p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/conditionals/0"><td class="td_notes"><div class="td_notes"><p>13</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{if ...}{/if}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>conditionals <em>(if variables are available)</em><sup>F</sup></p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/preload replace/0"><td class="td_notes"><div class="td_notes"><p>14</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{preload_replace:}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>preload replace variables</p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/extension tags/0"><td class="td_notes"><div class="td_notes"><p>15</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{exp:}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>extension tags - outer before inner<sup>AFGHIJ</sup></p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/php output/0"><td class="td_notes"><div class="td_notes"><p>16</p></div></td><td class="td_notes"><div class="td_notes"><p><code>&lt;?php ?&gt;</code></p></div></td><td class="td_notes"><div class="td_notes"><p>on output</p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/caching (if needed)/0"><td class="td_notes"><div class="td_notes"><p>17</p></div></td><td class="td_notes"><div class="td_notes"><p><strong>Caching...</strong></p></div></td><td class="td_notes"><div class="td_notes"><p>if needed, write the mostly parsed template to cache</p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/remaining conditionals/0"><td class="td_notes"><div class="td_notes"><p>18</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{if ...}{/if}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>Conditionals <em>(all remaining)</em><sup>FK</sup></p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/associated template layouts/0"><td class="td_notes"><div class="td_notes"><p>19</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{layout=}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>process the associated template <em>(this starts a new loop)</em></p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/all embeds/0"><td class="td_notes"><div class="td_notes"><p>20</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{embed=}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>tags - process all <em>(each embed starts a new loop)</em></p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/layouts cleanup/0"><td class="td_notes"><div class="td_notes"><p>21</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{layout:}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>Clean up unused tags. Hook here: <strong><em>template&#95;post_parse</em></strong></p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/redirects triggered/0"><td class="td_notes"><div class="td_notes"><p>22</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{redirect=}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>Trigger the first remaining tag<sup>JL</sup></p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/site and global vars/0"><td class="td_notes"><div class="td_notes"><p>23</p></div></td><td class="td_notes"><div class="td_notes"><p><code>site</code> and <code>global</code></p></div></td><td class="td_notes"><div class="td_notes"><p>template variables <em>(no conditionals allowed here)</em><sup>M</sup></p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/variables processing/0"><td class="td_notes"><div class="td_notes"><p>24</p></div></td><td class="td_notes"><div class="td_notes"><p><code>{stylesheet=}</code> <code>{encode=}</code></p><p><code>{path=}</code> <code>{route=}</code></p></div></td><td class="td_notes"><div class="td_notes"><p>tag processing</p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/security hashes/0"><td class="td_notes"><div class="td_notes"><p>25</p></div></td><td class="td_notes"><div class="td_notes"><p><strong>CSRF</strong></p></div></td><td class="td_notes"><div class="td_notes"><p>Add security hashes and <strong>ACT</strong> IDs</p></div></td></tr><tr id="//dash_ref_Quick Reference Guide/Entry/cleanup output/0"><td class="td_notes"><div class="td_notes"><p>26</p></div></td><td class="td_notes"><div class="td_notes"><p><strong>HTML output cleanup</strong></p></div></td><td class="td_notes"><div class="td_notes"><p>Remove any lingering EE comments<sup>A</sup></p></div></td></tr></table></div></section><section class="notes"><h2>Notes</h2><ol class="alpha_list"><li>Any EE comments are removed at this step</li><li>Template Partials (aka snippets aka global_vars) will override variables with matching names, but everything is parsed at once, meaning one variable’s output that contains the name of another will not parse<br><b>TL;DR:</b> You can’t nest Template Partials.</li><li>global_vars ≠ Global Template Variables i.e. there’s overlap but the two are not exactly the same</li><li>But not <code>{template_edit_date}</code> because it might need to be date formatted by step 8</li><li>It’s unclear how <code>{if in_group()}</code> works with “roles”</li><li>Conditionals will get parsed here if all their variables exist</li><li>Plugins parse inside to outside unless you use parse=”inward”</li><li><code>{exp:}</code> tags in the parameters of another tag get parsed first in most cases</li><li><code>{search:}</code> tags on any search results page can also be used as a parameter of an <code>{exp:}</code> tag</li><li><code>{redirect=}</code> in any triggered <code>{if no_results}</code> tag pair fires immediately when it is parsed</li><li>This step is still called “advanced conditionals” in the code, but it is not just those specifically</li><li>We would prefer to redirect before parsing all sub-templates, but we are sure there is a reason. Maybe so that you can redirect from an embed that is positioned in the main template ahead of another redirect?</li><li>This step now includes parsing the output of entry fields, which can mean variations in final output from earlier versions of EE</li></ol><p><strong>Version 1.0.1 (2021/04/28)</strong>, based on EE v6.0.3 <strong>/system/ee/legacy/libraries/Template.php</strong></p><p><a href="https://hopstudios.com/parse_order">ExpressionEngine Parse Order</a> prepared by Travis Smith &amp; Rowan Sentesy of Hop Studios (<a href="https://twitter.com/hopstudios">@hopstudios</a>) for #EECONF2021</p></section></article><footer>You can modify and improve this cheat sheet <a onclick="return window.dash.openExternal_(this.href),!1" href="http://cheat.kapeli.com">here</a></footer></body></html>