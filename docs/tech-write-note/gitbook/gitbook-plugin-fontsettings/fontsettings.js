require(["gitbook","jquery"],(function(e,t){var n,i,o=[{config:"white",text:"White",id:0},{config:"sepia",text:"Sepia",id:1},{config:"night",text:"Night",id:2}],a=[{config:"serif",text:"Serif",id:0},{config:"sans",text:"Sans",id:1}];function s(){e.storage.set("fontState",i),g()}function f(e){e.preventDefault(),i.size>=4||(i.size++,s())}function r(e){e.preventDefault(),i.size<=0||(i.size--,s())}function c(e,t){t&&t instanceof Event&&t.preventDefault();var n=u(e);i.family=n,s()}function l(t,n){n&&n instanceof Event&&n.preventDefault();var o=e.state.$book;0!==i.theme&&o.removeClass("color-theme-"+i.theme);var a=m(t);i.theme=a,0!==i.theme&&o.addClass("color-theme-"+i.theme),s()}function u(e){var n=t.grep(a,(function(t){return t.config==e}))[0];return n?n.id:0}function m(e){var n=t.grep(o,(function(t){return t.config==e}))[0];return n?n.id:0}function g(){var n=e.state.$book;t(".font-settings .font-family-list li").removeClass("active"),t(".font-settings .font-family-list li:nth-child("+(i.family+1)+")").addClass("active"),n[0].className=n[0].className.replace(/\bfont-\S+/g,""),n.addClass("font-size-"+i.size),n.addClass("font-family-"+i.family),0!==i.theme&&(n[0].className=n[0].className.replace(/\bcolor-theme-\S+/g,""),n.addClass("color-theme-"+i.theme))}function d(){n&&e.toolbar.removeButton(n),n=e.toolbar.createButton({icon:"fa fa-font",label:"Font Settings",className:"font-settings",dropdown:[[{text:"A",className:"font-reduce",onClick:r},{text:"A",className:"font-enlarge",onClick:f}],t.map(a,(function(e){return e.onClick=function(t){return c(e.config,t)},e})),t.map(o,(function(e){return e.onClick=function(t){return l(e.config,t)},e}))]})}e.events.bind("start",(function(t,n){var o=n.fontsettings;d(),function(t){var n=u(t.family),o=m(t.theme);i=e.storage.get("fontState",{size:t.size||2,family:n,theme:o}),g()}(o)})),e.fontsettings={enlargeFontSize:f,reduceFontSize:r,setTheme:l,setFamily:c,getThemes:function(){return o},setThemes:function(e){o=e,d()},getFamilies:function(){return a},setFamilies:function(e){a=e,d()}}}));