function Debouncer(e){this.callback=e,this.ticking=!1}window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,Matery.utils={listenScroll:function(e){return e=new Debouncer(e),window.addEventListener("scroll",e,!1),e.handleEvent(),e},unlistenScroll:function(e){window.removeEventListener("scroll",e)},scrollToElement:function(e,t){(e=jQuery(e).offset())&&jQuery("html,body").animate({scrollTop:e.top+(t||0),easing:"swing"})},elementVisible:function(e,t){t=t&&0<=t?t:0;e=e.getBoundingClientRect();var n=window.innerHeight||document.documentElement.clientHeight,i=e.top;return 0<=i&&i<=n*(t+1)||i<=0&&i>=-n*t-e.height},waitElementVisible:function(e,t,n){var i="undefined"!=typeof window,o=i&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);function r(e){var i;Matery.utils.elementVisible(e,n)?t():"IntersectionObserver"in window?new IntersectionObserver((function(e,n){e[0].isIntersecting&&(t(),n.disconnect())}),{threshold:[0],rootMargin:(window.innerHeight||document.documentElement.clientHeight)*n+"px"}).observe(e):i=Matery.utils.listenScroll((function(){Matery.utils.elementVisible(e,n)&&(Matery.utils.unlistenScroll(i),t())}))}i&&!o&&(n=n&&0<=n?n:0,"string"==typeof e?this.waitElementLoaded(e,(function(e){r(e)})):r(e))},waitElementLoaded:function(e,t){var n="undefined"!=typeof window,i=n&&!("onscroll"in window)||"undefined"!=typeof navigator&&/(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);n&&!i&&("MutationObserver"in window?new MutationObserver((function(n,i){var o=document.querySelector(e);o&&(t(o),i.disconnect())})).observe(document,{childList:!0,subtree:!0}):document.addEventListener("DOMContentLoaded",(function(){!function n(){var i=document.querySelector(e);i?t(i):setTimeout(n,100)}()})))},createScript:function(e,t){var n=document.createElement("script");(e=0<(e=(n.setAttribute("src",e),n.setAttribute("type","text/javascript"),n.setAttribute("charset","UTF-8"),n.async=!1,"function"==typeof t&&(window.attachEvent?n.onreadystatechange=function(){var e=n.readyState;"loaded"!==e&&"complete"!==e||(n.onreadystatechange=null,t())}:n.onload=t),document.getElementsByTagName("script"))).length?e[e.length-1]:document.head||document.documentElement).parentNode.insertBefore(n,e.nextSibling)},createCssLink:function(e){var t=document.createElement("link");(e=(t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),document.getElementsByTagName("link")[0]||document.getElementsByTagName("head")[0]||document.head||document.documentElement)).parentNode.insertBefore(t,e)},loadComments:function(e,t){var n=document.querySelector("#comments[lazyload]");n?Matery.utils.waitElementVisible(e,(function(){t(),n.removeAttribute("lazyload")}),CONFIG.lazyload.offset_factor):t()},getBackgroundLightness(e){var t=e;return(e=((t="string"==typeof e?document.querySelector(e):t).ownerDocument.defaultView||window).getComputedStyle(t).backgroundColor.replace(/rgba*\(/,"").replace(")","").split(/,\s*/)).length<3?0:0==(t=.213*e[0]+.715*e[1]+.072*e[2])||127.5<t?1:-1},retry(e,t,n){var i;n<=0||(i=function(){0<=--n&&!e()&&setTimeout(i,t)},setTimeout(i,t))}},Debouncer.prototype={constructor:Debouncer,update:function(){this.callback&&this.callback(),this.ticking=!1},requestTick:function(){this.ticking||(requestAnimationFrame(this.rafCallback||(this.rafCallback=this.update.bind(this))),this.ticking=!0)},handleEvent:function(){this.requestTick()}};