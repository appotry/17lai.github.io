<script src="https://cdn.jsdelivr.net/npm/echarts@5.3.3/dist/echarts.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3.6.1/dist/jquery.min.js"></script><div id="main" style="width:100%;height:100%;margin:0;padding:0"></div><script>var myChart=echarts.init(document.getElementById("main")),upColor="#00da3c",downColor="#ec0000";function splitData(e){for(var a=[],t=[],o=[],i=0;i<e.length;i++)a.push(e[i].splice(0,1)[0]),t.push(e[i]),o.push([i,e[i][4],e[i][0]>e[i][1]?1:-1]);return{categoryData:a,values:t,volumes:o}}function calculateMA(e,a){for(var t=[],o=0,i=a.values.length;o<i;o++)if(o<e)t.push("-");else{for(var r=0,l=0;l<e;l++)r+=a.values[o-l][1];t.push(+(r/e).toFixed(3))}return t}$.get("/html-file/echarts/data/stock-DJI.json",function(e){var a=splitData(e);myChart.setOption(option={backgroundColor:"#fff",animation:!1,legend:{bottom:10,left:"center",data:["Dow-Jones index","MA5","MA10","MA20","MA30"]},tooltip:{trigger:"axis",axisPointer:{type:"cross"},backgroundColor:"rgba(245, 245, 245, 0.8)",borderWidth:1,borderColor:"#ccc",padding:10,textStyle:{color:"#000"},position:function(e,a,t,o,i){var r={top:10};return r[["left","right"][+(e[0]<i.viewSize[0]/2)]]=30,r}},axisPointer:{link:{xAxisIndex:"all"},label:{backgroundColor:"#777"}},toolbox:{feature:{dataZoom:{yAxisIndex:!1},brush:{type:["lineX","clear"]}}},brush:{xAxisIndex:"all",brushLink:"all",outOfBrush:{colorAlpha:.1}},visualMap:{show:!1,seriesIndex:5,dimension:2,pieces:[{value:1,color:downColor},{value:-1,color:upColor}]},grid:[{left:"10%",right:"8%",height:"50%"},{left:"10%",right:"8%",top:"63%",height:"16%"}],xAxis:[{type:"category",data:a.categoryData,scale:!0,boundaryGap:!1,axisLine:{onZero:!1},splitLine:{show:!1},splitNumber:20,min:"dataMin",max:"dataMax",axisPointer:{z:100}},{type:"category",gridIndex:1,data:a.categoryData,scale:!0,boundaryGap:!1,axisLine:{onZero:!1},axisTick:{show:!1},splitLine:{show:!1},axisLabel:{show:!1},splitNumber:20,min:"dataMin",max:"dataMax"}],yAxis:[{scale:!0,splitArea:{show:!0}},{scale:!0,gridIndex:1,splitNumber:2,axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1},splitLine:{show:!1}}],dataZoom:[{type:"inside",xAxisIndex:[0,1],start:98,end:100},{show:!0,xAxisIndex:[0,1],type:"slider",top:"85%",start:98,end:100}],series:[{name:"Dow-Jones index",type:"candlestick",data:a.values,itemStyle:{color:upColor,color0:downColor,borderColor:null,borderColor0:null},tooltip:{formatter:function(e){return["Date: "+(e=e[0]).name+'<hr size=1 style="margin: 3px 0">',"Open: "+e.data[0]+"<br/>","Close: "+e.data[1]+"<br/>","Lowest: "+e.data[2]+"<br/>","Highest: "+e.data[3]+"<br/>"].join("")}}},{name:"MA5",type:"line",data:calculateMA(5,a),smooth:!0,lineStyle:{opacity:.5}},{name:"MA10",type:"line",data:calculateMA(10,a),smooth:!0,lineStyle:{opacity:.5}},{name:"MA20",type:"line",data:calculateMA(20,a),smooth:!0,lineStyle:{opacity:.5}},{name:"MA30",type:"line",data:calculateMA(30,a),smooth:!0,lineStyle:{opacity:.5}},{name:"Volume",type:"bar",xAxisIndex:1,yAxisIndex:1,data:a.volumes}]},!0),myChart.dispatchAction({type:"brush",areas:[{brushType:"lineX",coordRange:["2016-06-02","2016-06-20"],xAxisIndex:0}]})}),window.onresize=function(){myChart.resize()}</script>