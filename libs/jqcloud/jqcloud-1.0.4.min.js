!function(C){"use strict";C.fn.jQCloud=function(k,y){var R=this,b=R.attr("id")||Math.floor(1e6*Math.random()).toString(36),e={width:R.width(),height:R.height(),center:{x:(y&&y.width?y.width:R.width())/2,y:(y&&y.height?y.height:R.height())/2},delayedMode:50<k.length,shape:!1,encodeURI:!0,removeOverflowing:!0};function t(){for(var m=function(e,t){for(var i,h,n=0,n=0;n<t.length;n++)if(i=e,h=t[n],Math.abs(2*i.offsetLeft+i.offsetWidth-2*h.offsetLeft-h.offsetWidth)<i.offsetWidth+h.offsetWidth&&Math.abs(2*i.offsetTop+i.offsetHeight-2*h.offsetTop-h.offsetHeight)<i.offsetHeight+h.offsetHeight)return!0;return!1},e=0;e<k.length;e++)k[e].weight=parseFloat(k[e].weight,10);function i(e,t){var i,h,n=b+"_word_"+e,o=6.28*Math.random(),r=0,a=0,s=0,d=5,f="";if(t.html=C.extend(t.html,{id:n}),t.html&&t.html.class&&(f=t.html.class,delete t.html.class),k[0].weight>k[k.length-1].weight&&(d=Math.round((t.weight-k[k.length-1].weight)/(k[0].weight-k[k.length-1].weight)*9)+1),i=C("<span>").attr(t.html).addClass("w"+d+" "+f),h=t.link?("string"==typeof t.link&&(t.link={href:t.link}),y.encodeURI&&(t.link=C.extend(t.link,{href:encodeURI(t.link.href).replace(/'/g,"%27")})),C("<a>").attr(t.link).text(t.text)):t.text,i.append(h),t.handlers)for(var l in t.handlers)t.handlers.hasOwnProperty(l)&&"function"==typeof t.handlers[l]&&C(i).bind(l,t.handlers[l]);R.append(i);var c=i.width(),g=i.height(),u=y.center.x-c/2,w=y.center.y-g/2,p=i[0].style;for(p.position="absolute",p.left=u+"px",p.top=w+"px";m(i[0],v);){if("rectangular"===y.shape)switch(++a*M>(1+Math.floor(s/2))*M*(s%4%2==0?1:x)&&(a=0,s++),s%4){case 1:u+=M*x+2*Math.random();break;case 2:w-=M+2*Math.random();break;case 3:u-=M*x+2*Math.random();break;case 0:w+=M+2*Math.random()}else r+=M,o+=(e%2==0?1:-1)*M,u=y.center.x-c/2+r*Math.cos(o)*x,w=y.center.y+r*Math.sin(o)-g/2;p.left=u+"px",p.top=w+"px"}y.removeOverflowing&&(u<0||w<0||u+c>y.width||w+g>y.height)?i.remove():(v.push(i[0]),C.isFunction(t.afterWordRender)&&t.afterWordRender.call(i))}k.sort(function(e,t){return e.weight<t.weight?1:e.weight>t.weight?-1:0});var M="rectangular"===y.shape?18:2,v=[],x=y.width/y.height;y.delayedMode?function e(t){t=t||0,R.is(":visible")?t<k.length?(i(t,k[t]),setTimeout(function(){e(t+1)},10)):C.isFunction(y.afterCloudRender)&&y.afterCloudRender.call(R):setTimeout(function(){e(t)},10)}():(C.each(k,i),C.isFunction(y.afterCloudRender)&&y.afterCloudRender.call(R))}return y=C.extend(e,y||{}),R.addClass("jqcloud").width(y.width).height(y.height),"static"===R.css("position")&&R.css("position","relative"),setTimeout(function(){t()},10),R}}(jQuery);