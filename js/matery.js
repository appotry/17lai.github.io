$(function(){let e=function(){let e="animated pulse";$("article .article").hover(function(){$(this).addClass(e)},function(){$(this).removeClass(e)});$("#recommend-sections .post-card").hover(function(){$(this).addClass(e)},function(){$(this).removeClass(e)})};e();let t=function(e,t){let n=$("#"+e);if(n.length===0){return}let r=n.width();if(r>=450){r=r+21}else if(r>=350&&r<450){r=r+18}else if(r>=300&&r<350){r=r+16}else{r=r+14}$("#"+t).width(r)};let n=function(){jQuery(".content").css("min-height",window.innerHeight-165)};let r=function(){t("navContainer");t("artDetail","prenext-posts");n()};r();jQuery(window).resize(function(){r();AOS.refresh();progressBarInit()});Matery.events.registerRefreshCallback(function(){AOS.refresh();progressBarInit()});jQuery("#articles").masonry({itemSelector:".article"});AOS.init({easing:"ease-in-out-sine",duration:700,delay:100});$("#read_mode i").on("click",function(e){if(e.target!==this)return;$(this).parent().parent().parent().parent().toggleClass("card-block-fullscreen");$("html").toggleClass("card-block-fullscreen-html-scroll")});$("#read_mode span").on("click",function(e){if(e.target!==this)return;$(this).parent().parent().parent().parent().toggleClass("card-block-fullscreen");$("html").toggleClass("card-block-fullscreen-html-scroll")});let i=function(){$("#articleContent a[href^='http']").attr("target","_blank");$("#articleContent img").each(function(){let e=$(this).attr("src");$(this).wrap('<div class="img-item" data-src="'+e+'" data-sub-html=".caption"></div>');$(this).css("max-width","99%");$(this).addClass("img-shadow img-margin");let t=$(this).attr("alt");let n=$(this).attr("title");let r="";if(t===undefined||t===""){if(n!==undefined&&n!==""){r=n}}else{r=t}if(r!==""){let e=document.createElement("div");e.className="caption";let t=document.createElement("b");t.className="center-caption";t.innerText=r;e.appendChild(t);this.insertAdjacentElement("afterend",e)}});$("#articleContent, #myGallery").lightGallery({selector:".img-item",subHtmlSelectorRelative:true});$(document).find("img[data-original]").each(function(){$(this).parent().attr("href",$(this).attr("data-original"))});progressBarInit()};i();$(".modal").modal();jQuery(".sidenav").sidenav();let o=$("#headNav");let l=$(".top-scroll");a($(window).scrollTop());$(window).scroll(function(){let e=$(window).scrollTop();a(e)});function a(e){let t=100;if(e<t){o.addClass("nav-transparent");l.slideUp(300)}else{o.removeClass("nav-transparent");l.slideDown(300)}}$(".nav-menu>li").hover(function(){$(this).children("ul").stop(true,true).show();$(this).addClass("nav-show").siblings("li").removeClass("nav-show")},function(){$(this).children("ul").stop(true,true).hide();$(".nav-item.nav-show").removeClass("nav-show")});$(".m-nav-item>a").on("click",function(){if($(this).next("ul").css("display")=="none"){$(".m-nav-item").children("ul").slideUp(300);$(this).next("ul").slideDown(100);$(this).parent("li").addClass("m-nav-show").siblings("li").removeClass("m-nav-show")}else{$(this).next("ul").slideUp(100);$(".m-nav-item.m-nav-show").removeClass("m-nav-show")}});jQuery(".tooltipped").tooltip();if("serviceWorker"in navigator){navigator.serviceWorker.register("/sw.js").then(function(){console.log("Service Worker Registered")})}let s;let c=themeStorage.getItem("title");window.addEventListener("beforeinstallprompt",function(e){e.preventDefault();s=e;u()});function u(){let e="<span>使<b>"+c+'</b>可以离线访问？</span><button class="btn-flat toast-action" onclick="addToHomeScreen()">Yes</button>';M.toast({html:e})}function d(){s.prompt();s.userChoice.then(function(e){if(e.outcome==="accepted"){console.log("User accepted the A2HS prompt")}else{console.log("User dismissed the A2HS prompt")}s=null})}});function windowResizeEvent(){window.onresize=function(){var e=this;if(e.resizeFlag){clearTimeout(e.resizeFlag)}e.resizeFlag=setTimeout(function(){AOS.refresh();e.resizeFlag=null},100)}}function progressBarInit(){const n=window.document.querySelector(".progress-bar");if(n){new ScrollProgress((e,t)=>{n.style.width=t*100+"%"})}}function scrollToElement(e,t){var n=jQuery(e).offset();if(n){jQuery("html,body").animate({scrollTop:n.top+(t||0),easing:"swing"})}}function registerScrollDownArrowEvent(){var e=jQuery(".cover.scroll-down-bar");if(e.length===0){return false}e.on("click",function(){scrollToElement("main.content",-jQuery("#headNav").height()+30)})}function registerScrollBackCommentEvent(){var e=jQuery("#to_comment");if(e.length===0){return false}e.on("click",function(){scrollToElement("#comments",-jQuery("#headNav").height()+30)})}function postOutdate(){var e=document.getElementsByTagName("time");if(e.length===0){return}var t=document.getElementsByClassName("article-card-content");if(t.length===0){return}var n=new Date(e[0].dateTime);var r=new Date(e[1].dateTime);var i=Date.now();var o=parseInt(i-n);var l=parseInt(i-r);if(l>3600*24*30*12*1e3){var a=parseInt(o/864e5);var s=parseInt(l/864e5);articleContent.innerHTML='<div class="admonition warning"><p class="admonition-title">文章时效性提示</p><p>这是一篇发布于 '+a+" 天前，最近更新于 "+s+" 天前的文章，部分信息可能已发生改变，请注意甄别！"+"</p></div>"+articleContent.innerHTML}}function setLS(e,t){try{localStorage.setItem(e,t)}catch(e){}}function removeLS(e){try{localStorage.removeItem(e)}catch(e){}}function getLS(e){try{return localStorage.getItem(e)}catch(e){return null}}function registerColorToggleCallback(e,t,n){var r="#color-toggle-btn";var i=document.querySelector(r);i.addEventListener("click",function(){e.dispose();e=echarts.init(document.getElementById(t),getLS(colorSchemaInitStorageKey));e.setOption(n)})}function inPageScroll(){var e=function(e,t,n){for(var r=0;r<e.length;r++){t.call(n,r,e[r])}};var t=document.querySelectorAll("#articleContent a[href^='#']");if(window.scrollTo){e(t,function(e,t){var n=document.getElementById(t.getAttribute("href").substring(1));t.addEventListener("click",function(e){e.preventDefault();window.scrollTo(0,n.offsetTop)})})}}